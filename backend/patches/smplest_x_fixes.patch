diff --git a/human_models/human_models.py b/human_models/human_models.py
index bf824f5..4144696 100644
--- a/human_models/human_models.py
+++ b/human_models/human_models.py
@@ -25,11 +25,25 @@ class SMPLX:
         self.face = self.layer['neutral'].faces
         self.shape_param_dim = 10
         self.expr_code_dim = 10
-        with open(osp.join(human_model_path, 'smplx', 'SMPLX_to_J14.pkl'), 'rb') as f:
-            self.j14_regressor = pickle.load(f, encoding='latin1')
-        with open(osp.join(human_model_path, 'smplx', 'MANO_SMPLX_vertex_ids.pkl'), 'rb') as f:
-            self.hand_vertex_idx = pickle.load(f, encoding='latin1')
-        self.face_vertex_idx = np.load(osp.join(human_model_path, 'smplx', 'SMPL-X__FLAME_vertex_ids.npy'))
+        try:
+            with open(osp.join(human_model_path, 'smplx', 'SMPLX_to_J14.pkl'), 'rb') as f:
+                self.j14_regressor = pickle.load(f, encoding='latin1')
+        except FileNotFoundError:
+            print("WARNING: SMPLX_to_J14.pkl not found, setting to None")
+            self.j14_regressor = None
+
+        try:
+            with open(osp.join(human_model_path, 'smplx', 'MANO_SMPLX_vertex_ids.pkl'), 'rb') as f:
+                self.hand_vertex_idx = pickle.load(f, encoding='latin1')
+        except FileNotFoundError:
+            print("WARNING: MANO_SMPLX_vertex_ids.pkl not found, setting to None")
+            self.hand_vertex_idx = None
+            
+        try:
+            self.face_vertex_idx = np.load(osp.join(human_model_path, 'smplx', 'SMPL-X__FLAME_vertex_ids.npy'))
+        except FileNotFoundError:
+            print("WARNING: SMPL-X__FLAME_vertex_ids.npy not found, setting to None")
+            self.face_vertex_idx = None
         self.J_regressor = self.layer['neutral'].J_regressor.numpy()
         self.J_regressor_idx = {'pelvis': 0, 'lwrist': 20, 'rwrist': 21, 'neck': 12}
         self.orig_hand_regressor = self.make_hand_regressor()
diff --git a/models/SMPLest_X.py b/models/SMPLest_X.py
index 7218014..9017088 100644
--- a/models/SMPLest_X.py
+++ b/models/SMPLest_X.py
@@ -8,8 +8,13 @@ from models.module import TransformerDecoderHead, ViT
 from models.loss import CoordLoss, ParamLoss
 from human_models.human_models import SMPL, SMPLX
 from utils.transforms import rot6d_to_axis_angle, batch_rodrigues, rot6d_to_rotmat
+
 from utils.data_utils import load_img
 
+# Device detection for Mac/CUDA support
+DEVICE = torch.device('cuda' if torch.cuda.is_available() else 'mps' if torch.backends.mps.is_available() else 'cpu')
+
+
 
 class Model(nn.Module):
     def __init__(self, config, encoder, decoder):
@@ -22,7 +27,7 @@ class Model(nn.Module):
         self.decoder = decoder
 
         # loss
-        self.smplx_layer = copy.deepcopy(self.smpl_x.layer['neutral']).cuda()
+        self.smplx_layer = copy.deepcopy(self.smpl_x.layer['neutral']).to(DEVICE)
         self.coord_loss = CoordLoss()
         self.param_loss = ParamLoss()
 
@@ -44,14 +49,14 @@ class Model(nn.Module):
         gamma = torch.sigmoid(cam_param[:, 2])  # apply sigmoid to make it positive
         k_value = torch.FloatTensor([math.sqrt(self.cfg.model.focal[0] * self.cfg.model.focal[1] * 
                             self.cfg.model.camera_3d_size * self.cfg.model.camera_3d_size / (
-                self.cfg.model.input_body_shape[0] * self.cfg.model.input_body_shape[1]))]).cuda().view(-1)
+                self.cfg.model.input_body_shape[0] * self.cfg.model.input_body_shape[1]))]).to(DEVICE).view(-1)
         t_z = k_value * gamma
         cam_trans = torch.cat((t_xy, t_z[:, None]), 1)
         return cam_trans
 
     def get_coord(self, root_pose, body_pose, lhand_pose, rhand_pose, jaw_pose, shape, expr, cam_trans, mode):
         batch_size = root_pose.shape[0]
-        zero_pose = torch.zeros((1, 3)).float().cuda().repeat(batch_size, 1)  # eye poses
+        zero_pose = torch.zeros((1, 3)).float().to(DEVICE).repeat(batch_size, 1)  # eye poses
         # transl=cam_trans, 
         output = self.smplx_layer(betas=shape, body_pose=body_pose, global_orient=root_pose, right_hand_pose=rhand_pose,
                                   transl=cam_trans, left_hand_pose=lhand_pose, jaw_pose=jaw_pose, leye_pose=zero_pose,
diff --git a/utils/transforms.py b/utils/transforms.py
index c8a1ff3..35cae90 100644
--- a/utils/transforms.py
+++ b/utils/transforms.py
@@ -234,7 +234,7 @@ def rot6d_to_axis_angle(x):
     b3 = torch.cross(b1, b2)
     rot_mat = torch.stack((b1, b2, b3), dim=-1)  # 3x3 rotation matrix
 
-    rot_mat = torch.cat([rot_mat, torch.zeros((batch_size, 3, 1)).cuda().float()], 2)  # 3x4 rotation matrix
+    rot_mat = torch.cat([rot_mat, torch.zeros((batch_size, 3, 1)).to(x.device).float()], 2)  # 3x4 rotation matrix
     axis_angle = rotation_matrix_to_angle_axis(rot_mat).reshape(-1, 3)  # axis-angle 
     axis_angle[torch.isnan(axis_angle)] = 0.0
     return axis_angle
@@ -333,8 +333,8 @@ def soft_argmax_2d(heatmap2d):
     accu_x = heatmap2d.sum(dim=(2))
     accu_y = heatmap2d.sum(dim=(3))
 
-    accu_x = accu_x * torch.arange(width).float().cuda()[None, None, :]
-    accu_y = accu_y * torch.arange(height).float().cuda()[None, None, :]
+    accu_x = accu_x * torch.arange(width).float().to(heatmap2d.device)[None, None, :]
+    accu_y = accu_y * torch.arange(height).float().to(heatmap2d.device)[None, None, :]
 
     accu_x = accu_x.sum(dim=2, keepdim=True)
     accu_y = accu_y.sum(dim=2, keepdim=True)
@@ -354,9 +354,9 @@ def soft_argmax_3d(heatmap3d):
     accu_y = heatmap3d.sum(dim=(2, 4))
     accu_z = heatmap3d.sum(dim=(3, 4))
 
-    accu_x = accu_x * torch.arange(width).float().cuda()[None, None, :]
-    accu_y = accu_y * torch.arange(height).float().cuda()[None, None, :]
-    accu_z = accu_z * torch.arange(depth).float().cuda()[None, None, :]
+    accu_x = accu_x * torch.arange(width).float().to(heatmap3d.device)[None, None, :]
+    accu_y = accu_y * torch.arange(height).float().to(heatmap3d.device)[None, None, :]
+    accu_z = accu_z * torch.arange(depth).float().to(heatmap3d.device)[None, None, :]
 
     accu_x = accu_x.sum(dim=2, keepdim=True)
     accu_y = accu_y.sum(dim=2, keepdim=True)
